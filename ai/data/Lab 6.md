# LAB 6 "–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ú–ù–û–ì–û–°–õ–û–ô–ù–û–ì–û –ü–ï–†–°–ï–ü–¢–†–û–ù–ê"

## Target
—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Ç–∏–ø–∞ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω.

## Theory
–ö–∞–∫ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ—ë–≤. –ö–∞–∂–¥—ã–π —Å–ª–æ–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ–π—Ä–æ–Ω–æ–≤. –†–∞–Ω–µ–µ –º—ã —É–∂–µ –ø–∏—Å–∞–ª–∏ —Å–≤–æ–π –Ω–µ–π—Ä–æ–Ω, –≤–æ—Ç –∏–∑ —Ç–∞–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –∏ —Å–æ—Å—Ç–æ–∏—Ç MLP (Multi-Layer Perceptron). –ï—â—ë —Ç–∞–∫—É—é –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—É—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å, —É –∫–æ—Ç–æ—Ä–æ–π –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–≤–Ω–µ —Å–æ–µ–¥–∏–Ω—ë–Ω —Å –Ω–µ–π—Ä–æ–Ω–æ–º –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–≤–Ω–µ, –Ω–∞–∑—ã–≤–∞—é—Ç Fully-Connected-—Å–µ—Ç—å—é (–∏–ª–∏ Dense-—Å–µ—Ç—å—é).  
–†–∞—Å–º–æ—Ç—Ä–∏–º –∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ:  
–í–æ—Ç —Ç–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –¥–≤—É—Ö—Å–ª–æ–π–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å (–ø–µ—Ä–≤—ã–π —Å–ª–æ–π ‚Äì input layer ‚Äì –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ, –ø–æ —Å—É—Ç–∏, –Ω–µ —Å–ª–æ–π): 

<img width="221" height="161" alt="image" src="https://github.com/user-attachments/assets/f4d6f6dc-7774-4bc7-b63e-b58fb3ef0de6" />

–¢–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç—Ä—ë—Ö—Å–ª–æ–π–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å:

<img width="315" height="138" alt="image" src="https://github.com/user-attachments/assets/3a23d34f-40c6-486b-8d43-3f5df7a415d2" />

–ü—Ä–∏–º–µ—Ä –≥—Ä–∞–Ω–∏—Ü –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ MLP —Ä–∞–∑–ª–∏—á–Ω–æ–π –≥–ª—É–±–∏–Ω—ã –ø–æ–∫–∞–∑–∞–Ω –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ:
<img width="530" height="195" alt="image" src="https://github.com/user-attachments/assets/1d0605d7-d28e-4043-829f-c58a8165a478" />

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: —Å–≤—è–∑–∏ –µ—Å—Ç—å —É –Ω–µ–π—Ä–æ–Ω–æ–≤ —Å–æ —Å–ª–æ—è ùêøùëñ‚àí1 –∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ ùêøùëñ, –Ω–æ –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏ –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ —Å–≤—è–∑–µ–π –Ω–µ—Ç. –í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π ‚Äì —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ (–º–∞—Ç—Ä–∏—Ü–∞ (ùëõ,ùëö)). –°–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –≤—Ö–æ–¥–Ω—ã–º–∏ –∏–ª–∏ –≤—ã—Ö–æ–¥–Ω—ã–º–∏, –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–∫—Ä—ã—Ç—ã–º–∏ —Å–ª–æ—è–º–∏ (hidden layers).  
–ü—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ –æ–±—ã—á–Ω–æ –æ–¥–∏–Ω –Ω–µ–π—Ä–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞ (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –ø–æ —á–∏—Å–ª—É).  
–í —Å–ª—É—á–∞–µ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ –æ–±—ã—á–Ω–æ –æ–¥–∏–Ω –Ω–µ–π—Ä–æ–Ω, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏ ùêæ –Ω–µ–π—Ä–æ–Ω–æ–≤, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ ùêæ-–∫–ª–∞—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.  
### Forward pass –≤ MLP (–ø—Ä—è–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ –≤ MLP)
–ö–∞–∂–¥—ã–π —Å–ª–æ–π –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ ‚Äì —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤, —Å—Ç—Ä–æ–∫–∏ –∫–æ—Ç–æ—Ä–æ–π ‚Äì —ç—Ç–æ –Ω–µ–π—Ä–æ–Ω—ã (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äì –æ–¥–∏–Ω –Ω–µ–π—Ä–æ–Ω), –∞ —Å—Ç–æ–ª–±—Ü—ã ‚Äì –≤–µ—Å–∞ –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ (—Ç–æ –µ—Å—Ç—å –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äì —ç—Ç–æ –≤–µ—Å–∞ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞).  
–î–æ–ø—É—Å—Ç–∏–º, –º—ã —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É ùêæ-–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–ª–æ–µ ùêæ –Ω–µ–π—Ä–æ–Ω–æ–≤). –†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤—ã–≥–ª—è–¥–∏—Ç forward_pass –Ω–µ–π—Ä–æ—Å–µ—Ç–∏:  
–í—Ö–æ–¥ ‚Äì —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ (ùëÅ,ùëÄ).
```math
X = \begin{bmatrix}
x_{11} & ... & x_{1M} \\
... & ... & ... \\
x_{N1} & ... & x_{NM}
\end{bmatrix}
```
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏ ‚Äì —ç—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ª–æ—ë–≤, –≤ —Å–ª–æ—è—Ö –º–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–æ–≤. –ü–µ—Ä–≤—ã–π —Å–ª–æ–π (–ø–æ—Å–ª–µ –≤—Ö–æ–¥–Ω–æ–≥–æ) –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ (–º–∞—Ç—Ä–∏—Ü–∞ (ùëÄ,ùêø1))
```math
W^1 = \begin{bmatrix}
w_{11} & ... & w_{ML_1} \\
... & ... & ... \\
w_{M1} & ... & w_{ML_1}
\end{bmatrix}
```
–¢–æ –µ—Å—Ç—å —ç—Ç–æ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ ùêø1 –Ω–µ–π—Ä–æ–Ω–æ–≤, –∫–∞–∂–¥—ã–π –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Å–∞, –∏—Ö ùëÄ —à—Ç—É–∫.  
–°–ª–µ–¥—É–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –Ω–µ–π—Ä–æ–Ω ‚Äì —ç—Ç–æ –ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –ø–æ—Ç–æ–º –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ—Ç —ç—Ç–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –û–¥–Ω–∞–∫–æ –≤ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã—Ö –Ω–µ–π—Ä–æ—Å—Ç–µ—è—Ö —á–∞—Å—Ç–æ –æ—Ç–¥–µ–ª—è—é—Ç Linear —á–∞—Å—Ç—å –∏ Activation, —Ç–æ –µ—Å—Ç—å —Å–ª–æ–µ–º —Å—á–∏—Ç–∞–µ–º –Ω–∞–±–æ—Ä –≤–µ—Å–æ–≤ –Ω–µ–π—Ä–æ–Ω–æ–≤, –∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–æ–π –≤—Å–µ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (—É –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –∏–∑ —Å–ª–æ—è –æ–Ω–∞ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ, –æ–±—ã—á–Ω–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–¥–∞–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –Ω–µ–π—Ä–æ–Ω—É –≤ —Å–ª–æ–µ –æ—Ç–ª–∏—á–Ω—É—é –æ—Ç –¥—Ä—É–≥–∏—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ —ç—Ç–æ–º —Å–ª–æ–µ —Ñ—É–Ω–∫—Ü–∏—é –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å, –æ–±—ä—è–≤–∏–≤ —Å–ª–æ–π –∏–∑ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞).  
–î—Ä—É–≥–∏–µ —Å–ª–æ–∏ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –ø–µ—Ä–≤—ã–π —Å–ª–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—Ç–æ—Ä–æ–π —Å–ª–æ–π –±—É–¥–µ—Ç —Ç–∞–∫–æ–π (–º–∞—Ç—Ä–∏—Ü–∞ (ùêø1,ùêø2)):
```math
W^1 = \begin{bmatrix}
w_{11} & ... & w_{1L_1} \\
... & ... & ... \\
w_{L_11} & ... & w_{L_1L_2}
\end{bmatrix}
```
–¢–æ –µ—Å—Ç—å —ç—Ç–æ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ ùêø2 –Ω–µ–π—Ä–æ–Ω–æ–≤, –∫–∞–∂–¥—ã–π –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Å–∞, –∏—Ö ùêø1 —à—Ç—É–∫.  
–í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π. –ü—É—Å—Ç—å –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–æ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è –∏–¥—É—Ç ùë° —Å–ª–æ—ë–≤.  
–¢–æ–≥–¥–∞ –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π –∏–º–µ–µ—Ç —Ñ–æ—Ä–º—É:
```math
W^{out} = \begin{bmatrix}
w_{11} & ... & w_{1K} \\
... & ... & ... \\
w_{L_t1} & ... & w_{L_tK}
\end{bmatrix}
```
–¢–æ –µ—Å—Ç—å, –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–µ–π (ùêøùë°,ùêæ), –≥–¥–µ ùêøùë° ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ ùë°-–æ–º —Å–ª–æ–µ, –∞ ùêæ ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤.  
–í –∏—Ç–æ–≥–µ –¥–ª—è forward_pass –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–º–Ω–æ–∂–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—ã –¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º, –ø—Ä–∏–º–µ–Ω—è—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.  
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –º–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –æ–± —É–º–Ω–æ–∂–µ–Ω–∏–∏ –Ω–∞ –æ—á–µ—Ä–µ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –≤–µ—Å–æ–≤ –∫–∞–∫ –Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥ –≤ –Ω–æ–≤–æ–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –∫–æ–≥–¥–∞ –ø–æ–¥–∞—ë–º –º–∞—Ç—Ä–∏—Ü—É ùëã –∏ —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—è, –º—ã –ø–æ–ª—É—á–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞–∑–º–µ—Ä–∞ (ùëÅ,ùêø1), —Ç–æ –µ—Å—Ç—å –∫–∞–∫ –±—É–¥—Ç–æ ùêø1 ¬´–Ω–æ–≤—ã—Ö¬ª –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–∞–∫ –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∏ —É–∂–µ –∫–∞–∫ –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏).
### Backward pass –≤ MLP (–æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ)
–û–±—É—á–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ ¬´Error Backpropagation¬ª (–û–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–∫–∏), –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂ –Ω–∞ —Ç–æ, –∫–∞–∫ –º—ã –æ–±—É—á–∞–ª–∏ –æ–¥–∏–Ω –Ω–µ–π—Ä–æ–Ω ‚Äì —ç—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, –Ω–æ –ø–æ ¬´–≤—Å–µ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏¬ª —Å—Ä–∞–∑—É.
Backpropagation —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è chain rule (–ø–æ –ø—Ä–∞–≤–∏–ª—É –≤–∑—è—Ç–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π —Å–ª–æ–∂–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏)

## Practical
