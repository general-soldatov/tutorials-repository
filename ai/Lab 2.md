# LAB 2 "РАЗРАБОТКА МОДЕЛИ ЛИНЕЙНОЙ РЕГРЕССИИ"

## Target
получить навыки прогнозирования количественных признаков объекта (например, цены недвижимости, стоимости подержанных автомобилей, экономических показателей, прогноза состояния пациента и т. д.) на основе построения и оценки качества моделей регрессии.  

## Theory
Построение модели машинного обучения зависит от задачи, которую она должна решать. Выделяют три основные задачи:  
*	классификация (рассмотрена в предыдущих лабораторных работах);  
*	регрессия;  
*	кластеризация.   

Регрессия (regression) – это задача предсказания для каждого объекта значения, которое является действительным числом (например, прогноз стоимости акций, объема продаж товара, количества загрузок мобильного приложения и т. д.).  
Предположим, у объектов (красные точки) имеется единственный признак x. Тогда ось абсцисс будет соответствовать этому признаку x, а ось ординат – целевому значению y, зависящему от переменной x.  
Прямая линия – это построенная модель регрессии, цель которой – проходить максимально близко ко всем точкам. Построив модель регрессии, можно спрогнозировать целевое значение y при определенном значении переменной x.  
![image](https://github.com/user-attachments/assets/9c35deae-1814-4787-a6cb-5d7b6aabfaca)

## Practics
В новом блокноте создайте текстовую ячейку и впишите следующий текст: «Лабораторная работа студента группы … Фамилия Имя», указав свой номер группы, фамилию и имя.  
Установите пакет scikit-learn. Если библиотека уже установлена, этот шаг можно пропустить.  
```py
# загружаем библиотеку scikit-learn
!pip install scikit-learn
```
Модель для прогнозирования цен на недвижимость на основе датасета fetch_california_housing.
Для создания модели потребуются модули, фреймворки и датасеты библиотеки scikit-learn.
Загрузите необходимые для работы библиотеки.
```py
# download scikit-learn library
import numpy as np
import sklearn
from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.metrics import mean_squared_error
```
Загрузите данный датасет из модуля datasets библиотеки sklearn и обозначьте его как housing.
```py
# download dataset
housing = fetch_california_housing()
X, y = housing.data, housing.target
```
Ознакомьтесь с информацией о данном датасете, воспользовавшись таким параметром датасета, как ‘DESCR’.
```py
# info with housing dataset 
print(housing.DESCR)
```
Датасет содержит информацию о жилой недвижимости в Калифорнии. Каждый объект характеризуется восемью параметрами:   
*	MedInc – медианный доход жителей района (в десятках тысяч долларов);  
*	HouseAge – средний возраст домов в районе;  
*	AveRooms – среднее количество комнат на домохозяйство;  
*	AveBedrms – среднее количество спален на домохозяйство;  
*	Population – численность населения района;  
*	AveOccup – среднее количество жителей на домохозяйство;  
*	Latitude – географическая широта района;  
*	Longitude – географическая долгота района.  
Целевая переменная (MedHouseVal) – медианная стоимость дома в районе (в сотнях тысяч долларов).

Выведите на экран набор данных с параметрами объектов недвижимости.
```py
# print a dataset with the parametres of 10 real estate object
print(housing.data[0:10])
```
Каждый столбец в наборе данных характеризует параметры объекта недвижимости (например, средний возраст домов, численность населения района и др.). Каждая строка представляет параметры одного объекта недвижимости.
Выведите на экран цены десяти объектов недвижимости (метки).
```py
# print the labels of real estate objects
print(housing.target[0:10])
```
Процесс построения модели регрессии для предсказания цен объектов недвижимости делится на два этапа:  
*	обучение модели;  
*	тестирование модели (оценка надежности).  
Набор данных нужно разделить на обучающую и тестовую выборки:  
*	обучающая выборка содержит большую часть данных и используется для обучения;  
*	тестовая выборка служит для проверки качества модели.

Разбиение выполняется функцией train_test_split(X, y, train_size = k, random_state = 10), где X – данные с характеристиками объектов, y – метки объектов, k – доля датасета. Функция перемешивает данные и разделяет их в заданных пропорциях.
Разбейте датасет с данными об объектах недвижимости на обучающую и тестовую выборки. Обозначьте набор данных обучающей выборки следующим образом: данные с характеристиками объектов недвижимости – X_train, соответствующие им метки – y_train. Набор данных тестовой выборки обозначьте следующим образом: данные с характеристиками объектов недвижимости – X_test, соответствующие им метки – y_test.
Проверьте правильность разбиения датасета с помощью функции len, которая подсчитывает количество данных в массиве. 
```py
# spliting the datase into training and test samples
variant_number = 15
k = 1 - ((variant_number + 10) / 100)
X_train, X_test, y_train, y_test = train_test_split(
      X, y, train_size=k, random_state=10)
# checking the sample size
print(f"""Size of train samples: {len(X_train)} objects.
Size of test samples: {len(X_test)} objects.
""")
```
