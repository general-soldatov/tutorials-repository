# Выпуск SSL-сертификата
Если вы сейчас попытаетесь открыть страницу по прикрепленному домену, браузер может показать сообщение «Ваше подключение не является приватным».

Вместо сайта видим предупреждение.
Вы все сделали верно, осталось лишь выпустить для домена SSL-сертификат. Это цифровой сертификат, который подтверждает подлинность веб-сайта и позволяет использовать зашифрованное, а значит безопасное соединение.

# Выпуск сертификата SSL от Let’s Encrypt
Let’s Encrypt — это центр сертификации, предоставляющий бесплатные SSL/TLS сертификаты. Выдача сертификатов полностью автоматизирована и проста в реализации.

Подробную информацию о Let’s Encrypt вы найдете на официальном сайте.

## Подготовка
Для выпуска сертификата нам потребуется система Linux. При использовании Windows необходимо установить подсистему WSL, она позволяет запустить Linux среду на компьютере с Windows.

Для установки WSL с дистрибутивом Ubuntu для Linux откройте командную строку (cmd.exe) и введите команду:
```bash    
wsl --install
```
После окончания установки запустите программу WSL через графический интерфейс.

## Установка Certbot
Certbot — это клиент протокола ACME (Automatic Certificate Management Environment), который используется для управления SSL-сертификатами от Let’s Encrypt. При установке Certbot-клиента необходимы snap-пакеты, для управления которыми требуется snapd утилита. В Ubuntu она уже установлена по умолчанию, поэтому нам необходимо только проверить обновление ядра snapd до последней версии следующей командой:
```bash    
sudo snap install core; sudo snap refresh core
```
Далее устанавливаем пакет certbot:
```bash   
sudo snap install --classic certbot
```
После установки создаем символическую ссылку на команду certbot из каталога установки snap:
```bash    
sudo ln -s /snap/bin/certbot /usr/bin/certbot
```
## Выпуск SSL-сертификата
Выпустить сертификат через Certbot-клиента можно различными методами. Мы рассмотрим способ, который подразумевает внесение TXT-записи на домен.

Инициализируем процесс выпуска сертификата командой:
```bash   
sudo certbot certonly --authenticator manual --preferred-challenges dns
```
После выполнения команды появится строка:
```
Saving debug log to /var/log/letsencrypt/letsencrypt.log Please enter the domain name(s) you would like on your certificate (comma and/or space separated) (Enter 'c' to cancel):
```  
Вводим домен первого уровня, в нашем случае dinosaur-mood.ru, и нажимаем Enter.  
Таким образом мы направили запрос на выпуск сертификата для нашего домена. Процесс исполнения запроса сопровождается выводом строки:
```
Requesting a certificate for dinosaur-mood.ru.
```
Если запрос завершится успешно, в окне появится TXT-запись и ее значение.
Переходим в панель управления DNS-записями домена и добавляем полученную TXT-запись, как мы делали это ранее. Добавляем полученную TXT-запись.
После создания записи необходимо подождать некоторое время для обновления ее на домене. Для отслеживания результата можно воспользоваться сторонними интернет-ресурсами, например MxToolBox, также можно выполнить проверку в новом окне консоли через утилиту dig:
```bash    
dig _acme-challenge.dinosaur-mood.ru TXT
```
В ответе на запрос должна отображаться прописанная запись:
```   
;; ANSWER SECTION: 
_acme-challenge.dinosaur-mood.ru. 0 IN TXT "iLlPWHBLVdthtmcWvgsB8VwpWQXOdeShIK_3OlcM6Xc”
```
При корректном отображении записи переходим в окно, в котором у нас запущен процесс выдачи сертификата, и нажимаем Enter. Если сертификат успешно выдан, вы увидите следующий ответ:
```    
Successfully received certificate. #подверждение успешного выпуска сертификата
Certificate is saved at: /etc/letsencrypt/live/dinosaur-mood.ru/fullchain.pem #путь до сертификата на локальном хосте
Key is saved at: /etc/letsencrypt/live/dinosaur-mood.ru/privkey.pem # путь до приватного ключа сертификата на локальном хосте
This certificate expires on 2024-05-22. #дата истечения сертификата
These files will be updated when the certificate renews.
```
Обратите внимание, если вы используете данный способ, вам нужно будет через 90 дней продлить сертификат. Это можно сделать идентичным способом через Certbot.
