# LAB 7 "Управление данными СУБД MуSQL средствами РНР"

## Цель работы
Приобретение навыков доступа к базам данных в сети Интернет, используя возможности PHP. Задачами лабораторной работы являются овладение навыками создания и заполнения таблиц баз данных, создания представлений, триггеров и хранимых процедур, освоение программных технологий доступа к базам данных MySQL с помощью серверных сценариев PHP.

## Теоретическое введение
Первоначально сервер MySQL разрабатывался для управления большими базами данных с целью обеспечить более высокую скорость работы по сравнению с существующими на тот момент аналогами. И вот уже в течение нескольких лет данный сервер успешно используется в условиях промышленной эксплуатации с высокими требованиями. Несмотря на то, что MySQL постоянно совершенствуется, он уже сегодня обеспечивает широкий спектр полезных функций. Благодаря своей доступности, скорости и безопасности MySQL очень хорошо подходит для доступа к базам данных по Интернету.  
MySQL – это программное обеспечение с открытым кодом. Это означает, что применять и модифицировать его может любой желающий. Такое ПО можно получать по Internet и использовать бесплатно. При этом каждый пользователь может изучить исходный код и изменить его в соответствии со своими потребностями. Использование программного обеспечения MySQL регламентируется лицензией GPL (GNU General Public License), вкоторой указано, что можно и чего нельзя делать с этим программным обеспечением в различных ситуациях. MySQL можно загрузить с веб-сайта http://www.mysql.com/
Важной особенностью (и недостатком) MySQL является отсутствие поддержки ограничений уровня столбцов таблиц (например, даже такое простое ограничение, как проверка принадлежности числа заданному диапазону). При этом реализация ограничений с помощью программного кода (запросов check) возможна, но не действенна: написанные запросы будут без проблем выполнены СУБД, но проигнорированы при работе с таблицами.  
Рассмотренные ранее СУБД Access и SQL Server решали задачу создания ограничений целостности с помощью соответствующих ограничений (типа Check), доступных как в графическом, так и программном (с помощью непосредственного ввода кода) режимах. Те же самые задачи в MySQL решаются намного сложнее и требуют написания соответствующих программных триггеров.
Рассмотрим основные функции PHP, применяемые для работы с MySQL сервером.Основной функцией для соединения с сервером MySQL является mysql_connect(), которая подключает скрипт к серверу баз данных MySQL и выполяет авторизацию пользователя базой данных. Синтаксис у данной функции такой:
```php
mysql_connect ([string $hostname] [, string $user] [, sting $password]);
```
word]);
Все параметры данной функции являются необязательными, поскольку значения по умолчанию можно прописать в конфигурационном файле php.ini. При желании можно указать другие имя MySQL-хоста, пользователя и пароль. Параметр $hostname может быть указан в виде: хост:порт.
Функция возвращает идентификатор (типа int) соединения, и вся дальнейшая работа осуществляется только через этот идентификатор. При следующем вызове функции mysql_connect() с теми же параметрами новое соединение не будет открыто, а функция возвратит идентификатор существующего соединения. 
Для закрытия соединения предназначена функция mysql_close(int $connection_id).
Вообще, соединение можно и не закрывать - оно будет закрыто автоматически при завершении работы PHP скрипта. Если используется более одного соединения, при вызове mysql_close() нужно указать идентификатор соединения, которое вы хотите закрыть. Вообще не закрывать соединения - плохой стиль, лучше закрывать соединения с MySQL самостоятельно, а не надеясь на автоматизм PHP. Если используется только одно соединение с базой данных MySQL за все время работы сценария, то можно не сохранять его идентификатор и не указывать идентификатор при вызове остальных функций.
Функция mysql_connect() устанавливает обыкновенное соединение с MySQL. Однако, PHP поддерживает постоянные соединения - для этого используется функция mysql_pconnect(). Аргументы этой функции такие же, как и у mysql_connect().
В чем разница между постоянным соединением и обыкновенным соединением с MySQL? Постоянное соединение не закрывается после завершения работы скрипта, даже если скрипт вызвал функцию mysql_close(). Соединение закрывается лишь тогда, когда удаляется процесс-владелец (например, при завершении работы или перезагрузке вебсервера Apache). 
PHP работает с постоянными соединениями следующим образом: при вызове функции mysql_pconnect() PHP проверяет, было ли ранее установлено соединение. Если да, то возвращается его идентификатор, а если нет, то открывается новое соединение и возвращается идентификатор.
Постоянные соединения позволяют значительно снизить нагрузку на сервер, а также повысить скорость работы PHP скриптов, использующих базы данных. При работе с постоянными соединениями нужно следить, чтобы максимальное число клиентов Apache не преывшало максимального числа клиентов MySQL, то есть параметр MaxClient (в конфигурационном файле Apache - httpd.conf) должен быть меньше или равен параметру max_user_connection (параметр MySQL).
Функция mysql_select_db (string $db [, int $id]) выбирает базу данных, с которой будет работать PHP скрипт. Если открыто не более одного соединения, можно не указывать параметр $id.
Все запросы к текущей базе данных отправляются функцией mysql_query(). Этой функции нужно передать один параметр - текст запроса. Текст запроса может содержать пробельные символы и символы новой строки (\n). Текст должен быть составлен по правилам синтаксиса SQL. Пример запроса:
```php
$q = mysql_query("SELECT * FROM mytable");
```
Приведенный запрос должен вернуть содержимое таблицы mytable. Результат запроса присваивается переменной $q. Результат - это набор данных, который после выполнения запроса нужно обработать определенным образом.
Есть возможность узнать значение каждого поля. Это можно сделать с помощью следующей функции:
```php
mysql_result (int $result, int $row, mixed $field);
```
Параметр функции $row задает номер записи, а параметр $field - имя или порядковый номер поля.

## Порядок выполнение
1. Зайдите в панель управления хостинга и создайте базу данных.
2. Перейдите в панель управления phpMyAdmin, раздел SQL и напишите запрос на создание таблицы:
```sql
CREATE TABLE students(
    id INT PRIMARY KEY AUTO_INCREMENT, 
    learn_book_id INT(6) UNIQUE,
    first_name varchar(20),
    name varchar(20),
    speciality varchar(7),
    birth_date date,
    course int(1),
    group_num int(2)
    );
```

## Содержание отчёта
