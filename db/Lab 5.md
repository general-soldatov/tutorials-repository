# LAB 5 «ПРОДВИНУТАЯ РАБОТА С ДАННЫМИ В PostgreSQL»

В PostgreSQL предусмотрен ряд встроенных функций для работы с числами.
Функция ABS: Функция ABS(n) возвращает абсолютное значение числа n. Напри-мер:
```sql
SELECT ABS(100) X1, ABS(-100) X2, ABS(-100.2) X3;
```
Функция CEIL: Функция CEIL(n) возвращает наименьшее целое, большее или рав-ное переданному в качестве параметра числу n. Например:
```sql
SELECT CEIL(100) X1, CEIL(-100) X2, CEIL(100.2) X3, CEIL(-100.2) X4;
```
Функция FLOOR: Функция FLOOR(n) возвращает наибольшее целое, меньшее или равное переданному в качестве параметра числу n. Например:
```sql
SELECT FLOOR(100.22) X1, FLOOR(-100.22) X2, FLOOR(100.99) X3, 
FLOOR(100.01) X4;
```
Функция TRUNC: Функция TRUNC(n[, m]) возвращает число n, усеченное до m знаков после десятичной точки. Параметр mможет не указываться – в этом случае n усе-кается до целого.
```sql
SELECT TRUNC(100.25678) X1, TRUNC(-100.25678) X2, TRUNC(100.99) X3, TRUNC(100.25678, 2) X4;
```
Функция ROUND: Функция ROUND(n[,m]) возвращает число n, округленное до m знаков после десятичной точки по правилам математического округления. Параметр m может не указываться – в этом случае n округляется до целого.
```sql
SELECT ROUND(100.25678) X1, ROUND(100.5) X2, ROUND(100.99) X3, 
ROUND(100.25678, 2) X4;
```
Функция SIGN: Функция SIGN(n) определяет знак числа. Если n положительное, то функция возвращает 1. Если отрицательное – возвращается –1. Если равно нулю, то воз-вращается 0. Например:
```sql
SELECT SIGN(100.22) X1, SIGN(-100.22) X2, SIGN(0) X3;
```
Функция MOD: ФункцияMOD(n,m)возвращает остаток от деления n на m. Напри-мер:
```sql
SELECT MOD(10, 3) X1, MOD(10, 2) X2, MOD(100, 98) X3;
```
Функция POWER: Функция POWER(n,m)возводит число n в степень m. Степень может быть дробной и отрицательной, что существенно расширяет возможности данной функции.
```sql
SELECT POWER(10, 2) X1, POWER(100, 0.5) X2, POWER(1000, 0.33333333) X3, 
POWER(1000, -0.33333333) X4;
```
Функция SQRT: Функция SQRT(n)возвращает квадратный корень от числа n. Например:
```sql
SELECT SQRT(100) X;
```
Функции EXP и LN: Функция EXP(n) возводит e в степень n, а функция LN(n) вы-числяет натуральный логарифм от n (при этом значение n должно быть больше нуля). Пример:
```sql
SELECT EXP(1) X1, LN(1) X2, LN(EXP(2)) X3;
```
Функция LOG: Функция LOG(n, m) производит вычисление логарифма m по осно-ванию n. Пример:
```sql
SELECT LOG(2, 8) X1, LOG(10, 100) X2;
```
PostgreSQL поддерживает вычисление основных тригонометрических функций:
```sql
SIN(n) – синус n (где n – угол в радианах);
COS(n) – косинус n (где n – угол в радианах);
TAN(n) – тангенс n (где n – угол в радианах);
COT(n) – котангенс n (где n – угол в радианах). Пример:
SELECT SIN(0) X1, COS(0) X2, TAN(0) X3, COT(0);
```
Строковые и символьные функции
Функция CONCAT(str1, str2) выполняет конкатенацию строк str1и str2. Если один из аргументов равен NULL, то он воспринимается как пустая строка. Если оба аргумента равны NULL, то функция возвращает NULL. Пример:
```sql
SELECT CONCAT(' попа ', 'была собака') X1,
CONCAT('Test', NULL) X2,
CONCAT(NULL, 'Test') X3,
CONCAT(NULL, NULL) X4;
```
Для конкатенации строк PostgreSQL поддерживает специальный оператор конка-тенации ||.
Функция LOWER(str) преобразует все символы строки str в строчные. Пример:
```sql
SELECT LOWER('TeXt DATA') X;
```
Функция UPPER(str) преобразует все символы строки str в прописные. Пример:
```sql
SELECT UPPER('TeXt DATA') X;
```
Функция INITCAP(str) возвращает строку str, в которой первые буквы всех слов преобразованы в прописные. Функция удобна для форматирования полного имени при построении отчетов. Пример:
```sql
SELECT INITCAP ('ИваноВ петр сиДорович') X;
```
Функция LTRIM(str [,set]) удаляет все символы с начала строки до первого симво-ла, которого нет в наборе символов set. По умолчанию set состоит из одного пробела и может не указываться. 
Функция RTRIM(str [,set]) аналогична LTRIM, но удаляет символы, начиная от конца строки. Рассмотрим несколько примеров:
```sql
SELECT LTRIM('TeXt DATA') X1,
LTRIM(' _ # TeXt DATA', ' #_') X2,
LTRIM(' 1234567890 TeXt DATA', ' 1234567890') X3
UNION ALL
SELECT RTRIM('TeXt DATA') X1,
RTRIM('TeXt DATA _ # ', ' #_') X2,
RTRIM('TeXt DATA 1234567890 ', ' 1234567890') X3;
```
Функция REPLACE(str, search_str, replace_str) осуществляет поиск образца search_str в строке str и каждое найденное вхождение заменяет на replace_str. Поиск под-строки ведется с учетом регистра. Пример:
```sql
SELECT REPLACE('У попа была собака', 'собака', 'кошка') X1,
REPLACE('У попа была злая собака', 'злая', '') X2,
REPLACE('У попа была собака', 'Собака', 'Кошка') X3;
```
Функция LENGTH(str) возвращает длину строки str в символах. Для пустой строки функция вернет 0, а для значения NULL – NULL. Пример:
```sql
SELECT LENGTH('У попа была собака') X1,
LENGTH('') X2,
LENGTH(NULL) X3;
```
Функции работы с датой и временем
Функция NOW – это одна из самых часто употребляемых функций, она возвраща-ет текущую дату и время по часам сервера. Пример:
```sql
SELECT NOW();
```
Функция JUSTIFY_INTERVAL(interval) преобразует интервал (тип interval), указан-ный в виде строки в соответствующее значение типа timestamp. Пример:
```sql
SELECT NOW() D1,
NOW() + JUSTIFY_INTERVAL('30 DAYS 1 HOUR 2 MINUTE')
D2, NOW() - JUSTIFY_INTERVAL('30 DAYS 1 HOUR 2
MINUTE') D3;
```
Функция DATE_TRUNC(timestamp) используется для обрезки даты или интервала (DATE_TRUNC(interval)) до определенной точности. Пример:
```sql
SELECT
DATE_TRUNC('HOUR', NOW()) D1,
DATE_TRUNC('DAY', NOW()) D2,
DATE_TRUNC('MONTH', NOW()) D3;
```
Функция AGE([end_date, ]start_date) возвращает разницу между датами, обозна-ченными как end_date и start_date. Если параметр end_date опущен, то используется зна-чение глобальной переменной CURRENT_DATE, которая содержит текущую дату (тип date, дата без времени). Пример:
```sql
SELECT CURRENT_DATE D1, 
AGE(MAKE_TIMESTAMP(2013, 7, 15, 8, 15, 23.5))
D2, AGE(MAKE_DATE(2016, 3, 3),
MAKE_TIMESTAMP(2013, 7, 15, 8, 15, 23.5)) D3;
```
Функция EXTRACT(field FROM timestamp) извлекает элемент даты field из значе-ния типа timestamp. Также существует функция EXTRACT(field FROM interval) для ра-боты со значениями типа interval. Пример:
```sql
SELECT
NOW() D1,
EXTRACT(MONTH FROM NOW()) D2,
EXTRACT(YEAR FROM NOW()) D3,
EXTRACT(MINUTE FROM NOW()) D4;
```
Порядок выполнения
1.	Найдите значения числовой функции, при Х = 3,1:	 
![image](https://github.com/user-attachments/assets/6628d34d-4ea5-4572-b586-9b2fffeb1a29)

2.	Дана строка 'minsk'. Сделайте из нее строку 'MINSK'
3.	Дана строка 'MINSK'. Сделайте из нее строку 'Minsk'.
4.	В переменной $date лежит дата в формате '31-12-2030'.
5.	Преобразуйте эту дату в формат '2030.12.31'.
6.	Дана строка 'php'. Сделайте из нее строку 'PHP'.
7.	Дана строка 'PHP'. Сделайте из нее строку 'php'.
8.	Дана строка 'london'. Сделайте из нее строку 'London'.
9.	Дана строка 'London'. Сделайте из нее строку 'london'.
10.	Дана строка 'london is the capital of great britain'. Сделайте из нее строку 'London Is The Capital Of Great Britain'.
11.	Дана строка 'LONDON'. Сделайте из нее строку 'London'.
12.	Дана строка 'html css php'. Вырежьте из нее и выведите на экран слово 'html', слово 'css' и слово 'php'.
13.	Дана строка. Вырежите и выведите на экран последние 3 символа этой строки.
14.	Дана строка. Проверьте, что она начинается на 'http://'. Если это так, выведите 'да', если не так - 'нет'.
15.	Дана строка. Проверьте, что она начинается на 'http://' или на 'https://'. Если это так, выведите 'да', если не так - 'нет'.
16.	Дана строка. Проверьте, что она заканчивается на '.png'. Если это так, выведите 'да', если не так - 'нет'.
17.	Дана строка. Проверьте, что она заканчивается на '.png' или на '.jpg'. Если это так, выведите 'да', если не так - 'нет'.
